<div  class="sixteen columns fc_sidebar">
<div class="four columns fc_sidebar_content">
  <h4>{{ collection.title }}</h4>
  <span><img src='{% if collection.image %}{{ collection.image | img_url: 'medium' }}{% else %}{{ collections['food-court'].image | img_url: 'medium' }}{% endif %}'></span>
</div>

<div class="twelve columns fc_sidebar_content">

<div class="four columns filter_margin_bottom omega filter_margin_top">
   <label class="inline">{{ 'collections.sidebar.style' | t }}: </label> 
    <select class="coll-picker">
    <option value="food-court">All</option>
    {% for link in linklists['food-court'].links %}
    {% assign c = link.object %}
    {% if collection.handle == c.handle %}
    <option value="{{ c.handle }}" selected>{{ c.title }}</option>
    {% else %}
    <option value="{{ c.handle }}">{{ c.title }}</option>
    {% endif %}
    {% endfor %}
    </select>
</div>
    
<div class="four columns filter_margin_bottom omega filter_margin_top">
   <label class="inline">{{ 'collections.sidebar.restaurant' | t }}: </label> 
    {% assign tags = settings.filter_restaurant | split: ',' %}
    <select class="coll-filter">
      <option value="">All</option>
      {% for t in tags %}
      {% assign tag = t | strip %}
      {% if current_tags contains tag %}
      <option value="{{ tag | handle }}" selected>{{ tag }}</option>
      {% elsif collection.tags contains tag %}
      <option value="{{ tag | handle }}">{{ tag }}</option>
      {% endif %}
      {% endfor %}
    </select>
  </div>
    
<div class="four columns filter_margin_bottom omega filter_margin_top">
   <label class="inline">{{ 'collections.sidebar.location' | t }}: </label> 
   {% assign tags = settings.filter_location | split: ',' %}
    <select class="coll-filter">
      <option value="">All</option>
      {% for t in tags %}
      {% assign tag = t | strip %}
      {% if current_tags contains tag %}
      <option value="{{ tag | handle }}" selected>{{ tag }}</option>
      {% elsif collection.tags contains tag %}
      <option value="{{ tag | handle }}">{{ tag }}</option>
      {% endif %}
      {% endfor %}
    </select>
  </div>
  
<div class="four columns filter_margin_bottom omega filter_margin_top">
   <label class="inline">{{ 'collections.sidebar.type' | t }}: </label> 
   {% assign tags = settings.filter_type | split: ',' %}
    <select class="coll-filter">
      <option value="">All</option>
      {% for t in tags %}
      {% assign tag = t | strip %}
      {% if current_tags contains tag %}
      <option value="{{ tag | handle }}" selected>{{ tag }}</option>
      {% elsif collection.tags contains tag %}
      <option value="{{ tag | handle }}">{{ tag }}</option>
      {% endif %}
      {% endfor %}
    </select>
  </div>
  
    <div class="four columns filter_margin_bottom omega filter_margin_top">
          <label for="sort" class="inline">{{ 'collections.sorting.title' | t }}: </label> 
          <select id="sort">
            <option value="manual">{{ 'collections.sorting.featured' | t }}</option>
            <option value="best-selling">{{ 'collections.sorting.best_selling' | t }}</option>
            <option value="title-ascending">{{ 'collections.sorting.az' | t }}</option>
            <option value="title-descending">{{ 'collections.sorting.za' | t }}</option>
            <option value="price-ascending">{{ 'collections.sorting.price_ascending' | t }}</option>
            <option value="price-descending">{{ 'collections.sorting.price_descending' | t }}</option>
            <option value="created-descending">{{ 'collections.sorting.date_descending' | t }}</option>
            <option value="created-ascending">{{ 'collections.sorting.date_ascending' | t }}</option>
          </select>
          <script type="text/javascript">
            // <![CDATA[  
              $('#sort')
                .val('{{ collection.sort_by | default: collection.default_sort_by  }}')
                .bind('change', function() {
                  Shopify.queryParams.sort_by = $(this).val();
                  location.search = $.param(Shopify.queryParams);
              });
            // ]]>
          </script>
        </div>
  </div>
</div>

<script>
  /* Product Tag Filters - Good for any number of filters on any type of collection page.
     Give you product tag filter select element a class of coll-filter.
     Give your collection select a class of coll-picker.
     Brought to you by Caroline Schnapp. */
  Shopify.queryParams = {};
  if (location.search.length) {
    for (var aKeyValue, i = 0, aCouples = location.search.substr(1).split('&'); i < aCouples.length; i++) {
      aKeyValue = aCouples[i].split('=');
      if (aKeyValue.length > 1) {
        Shopify.queryParams[decodeURIComponent(aKeyValue[0])] = decodeURIComponent(aKeyValue[1]);
      }
    }
  }
  jQuery('.coll-picker').change(function() {
    if (jQuery(this).val()) {
      location.href = '/collections/' + jQuery(this).val();
    }
    else {
      location.href = '/collections/all';
    }
  });
  var collFilters = jQuery('.coll-filter');
  collFilters.change(function() {
    delete Shopify.queryParams.page;
    var newTags = [];
    collFilters.each(function() { 
      if (jQuery(this).val()) {
        newTags.push(jQuery(this).val());
      }
    });
    {% if collection.handle %}
    var newURL = '/collections/{{ collection.handle }}';
    if (newTags.length) {
      newURL += '/' + newTags.join('+');
    }
    var search = jQuery.param(Shopify.queryParams);
    if (search.length) {
      newURL += '?' + search;
    }
    location.href = newURL;
    {% else %}
    if (newTags.length) {
      Shopify.queryParams.constraint = newTags.join('+');
    }
    else {
      delete Shopify.queryParams.constraint;
    }
    location.search = jQuery.param(Shopify.queryParams);
    {% endif %}      
  });
</script>